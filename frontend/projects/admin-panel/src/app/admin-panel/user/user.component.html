<div>
  <div class="row">
    <div>
      <a href="#" class="btn btn-success btn-round" (click)="$event.preventDefault();open()">Создать пользователя<div class="ripple-container"></div></a>
      <div class="card w1600">
        <div class="card-body">
          <div class="d-flex justify-content-between">
            <form class="w-100" [formGroup]="filter">
              <div class="d-flex flex-wrap">
                <div class="filter-form-wrapper w25">
                  <label class="col-form-label">Роль</label>
                  <div class="form-group has-default bmd-form-group" style="margin-left: 13px;">
                    <app-custom-select classes="special mr-3" [values]="possibleRoles" formControlName="roles"></app-custom-select>
                  </div>
                </div>
                <div class="filter-form-wrapper w50">
                  <div class="d-flex w-50">
                    <label class="col-form-label">Дата регистрации</label>
                    <div class="form-group bmd-form-group position-relative">
                      <input type="text" class="form-control" formControlName="dateStart"
                             ngbDatepicker [autoClose]="true"
                             readonly #start="ngbDatepicker"
                             (dateSelect)="dateInvalid('dateStart','dateEnd')"
                             >
                      <a (click)="$event.preventDefault();filter.controls.dateStart.reset();start.open()"><i class="material-icons icon-color position-absolute" style="top: 10px;right: -22px">date_range</i></a>
                    </div>
                  </div>
                  <div class="d-flex w-50">
                    <label class="col-form-label">до</label>
                    <div class="form-group bmd-form-group position-relative">
                      <input type="text" class="form-control" formControlName="dateEnd"
                             ngbDatepicker [autoClose]="true"
                             readonly #end="ngbDatepicker"
                             (dateSelect)="dateInvalid('dateStart','dateEnd')"
                             >
                      <a (click)="$event.preventDefault();filter.controls.dateEnd.reset();end.open()"><i class="material-icons icon-color position-absolute" style="top: 10px;right: -22px">date_range</i></a>
                    </div>
                  </div>
                </div>
                <div class="filter-form-wrapper w25">
                  <label class="col-form-label">Телефон</label>
                  <div class="form-group has-default bmd-form-group">
                    <input type="tel" class="form-control" prefix="+7" mask="(000) 000 00 00" formControlName="username">
                  </div>
                </div>
<!--                <div class="d-flex">-->
<!--                  <label class="col-form-label">ФИО</label>-->
<!--                  <div class="form-group has-default bmd-form-group">-->
<!--                    <input type="text" class="form-control">-->
<!--                  </div>-->
<!--                </div>-->

<!--                <div class="d-flex">-->
<!--                  <label class="col-form-label">Статус</label>-->
<!--                  <div class="form-group has-default bmd-form-group">-->
<!--                    <app-custom-select classes="special mr-3" formControlName="phone" [values]="[1,2,3,4,5,6,7,8,9,10]"></app-custom-select>-->
<!--                  </div>-->
<!--                </div>-->
                <div class="filter-form-wrapper w25">
                  <label class="col-form-label" style="padding-right: 20px;">ФИО</label>
                  <div class="form-group has-default bmd-form-group">
                    <input type="text" class="form-control" formControlName="realname" style="width: 160px!important;">
                  </div>
                </div>
                <div class="filter-form-wrapper w25">
                  <label class="col-form-label">ID пользователя</label>
                  <div class="form-group has-default bmd-form-group">
                    <input type="text" class="form-control w260" formControlName="id" style="width: 190px!important;">
                  </div>
                </div>
                <div class="filter-form-wrapper w25">
                  <label class="col-form-label">Email</label>
                  <div class="form-group has-default bmd-form-group">
                    <input type="email" class="form-control w160" formControlName="email">
                  </div>
                </div>
                <div class="filter-form-wrapper w25">
                  <label class="col-form-label">Статус</label>
                  <div class="form-group has-default bmd-form-group">
                    <app-custom-select classes="special mr-3" [values]="possibleStatuses" formControlName="status"></app-custom-select>
<!--                    <input type="email" class="form-control" formControlName="status">-->
                  </div>
                </div>
              </div>
            </form>
            <div class="d-flex flex-column align-items-center justify-content-around">
              <button class="btn slim btn-success btn-round" (click)="filterFields()">Показать<div class="ripple-container"></div></button>
              <button class="btn btn-transparent d-flex align-items-center" (click)="clearFilter()">
                <i class="material-icons-outlined">close</i> Очистить
                <div class="ripple-container"></div></button>
            </div>
          </div>
        </div>
      </div>
      <div class="card w1600">
        <div class="card-header card-header-success card-header-icon">
          <div class="card-icon">
            <i class="material-icons-outlined">perm_identity</i>
          </div>
          <h4 class="card-title ">Администраторы</h4>
        </div>
        <div class="card-body">
          <!--          <div class="tab-content tab-space">-->
          <!--              <ng-scrollbar [visibility]="'always'" style="height: 450px; width: 1620px">-->

          <div class="material-datatables">
            <div id="datatables_wrapper" class="dataTables_wrapper dt-bootstrap4">
              <div class="row">
                <div class="col-sm-12 col-md-6">
                  <div class="dataTables_length" id="datatables_length">
                    <label class="d-flex align-items-baseline">Show <app-custom-select classes="tight" [values]="[10,20,50]" [placeholder]="10"></app-custom-select> entries</label>
                  </div>
                </div>
                <div class="col-sm-12 col-md-6">
                  <div class="dataTables_filter">
                    <label>INPUT<span class="bmd-form-group bmd-form-group-sm">
                        <input type="search" class="form-control form-control-sm" placeholder="Search records" aria-controls="datatables" [formControl]="tableSearch"></span>
                    </label>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-sm-12">
                  <ng-scrollbar class="transactions-scroll" [visibility]="'always'">
                    <table class="table table-striped table-no-bordered table-hover dataTable dtr-inline" cellspacing="0" width="100%" style="width: 100%;" role="grid" aria-describedby="datatables_info">
                      <thead>
                      <tr role="row">
                        <th class="sortable-th" (click)="nextSort('id')"><span [class.sorting_desc]="sortHelper.sort.sortBy === 'id'" [class.sorting_asc]="sortHelper.sort.increase&&sortHelper.sort.sortBy === 'id'">ID пользователя</span></th>
                        <th class="sortable-th" (click)="nextSort('timestamp')"><span [class.sorting_desc]="sortHelper.sort.sortBy === 'timestamp'" [class.sorting_asc]="sortHelper.sort.increase&&sortHelper.sort.sortBy === 'timestamp'">Дата регистрации</span></th>
                        <th class="sortable-th" (click)="nextSort('username')"><span [class.sorting_desc]="sortHelper.sort.sortBy === 'username'" [class.sorting_asc]="sortHelper.sort.increase&&sortHelper.sort.sortBy === 'username'">Телефон</span></th>
                        <th class="sortable-th" (click)="nextSort('email')"><span [class.sorting_desc]="sortHelper.sort.sortBy === 'email'" [class.sorting_asc]="sortHelper.sort.increase&&sortHelper.sort.sortBy === 'email'">Email</span></th>
                        <th class="sortable-th" (click)="nextSort('realname')"><span [class.sorting_desc]="sortHelper.sort.sortBy === 'realname'" [class.sorting_asc]="sortHelper.sort.increase&&sortHelper.sort.sortBy === 'realname'">ФИО</span></th>
                        <th class="sortable-th" (click)="nextSort('roles')"><span [class.sorting_desc]="sortHelper.sort.sortBy === 'roles'" [class.sorting_asc]="sortHelper.sort.increase&&sortHelper.sort.sortBy === 'roles'">Роль</span></th>
                        <th class="sortable-th" (click)="nextSort('status')"><span [class.sorting_desc]="sortHelper.sort.sortBy === 'status'" [class.sorting_asc]="sortHelper.sort.increase&&sortHelper.sort.sortBy === 'status'">Статус</span></th>
                      </thead>
                      <tfoot>
                      <tr>
                        <th rowspan="1" colspan="1">ID Пользователя</th>
                        <th rowspan="1" colspan="1">Дата регистрации</th>
                        <th rowspan="1" colspan="1">Телефон</th>
                        <th rowspan="1" colspan="1">Email</th>
                        <th rowspan="1" colspan="1">ФИО</th>
                        <th rowspan="1" colspan="1">Роль</th>
                        <th rowspan="1" colspan="1">Статус</th>
                      </tr>
                      </tfoot>
                      <tbody>
                      <tr role="row" class="cursor-pointer" (click)="navigateToSettings(user.id)" *ngFor="let user of sortedActions">
                        <td tabindex="0" class="sorting_1">{{user.id}}</td>
                        <td>{{user.timestamp | date :'dd.MM.YYYY'}}</td>
                        <td>{{user.username}}</td>
                        <td>{{user.email}}</td>
                        <td>{{user.realname}}</td>
<!--                        <td>{{user.roles}}</td>-->
                        <td>{{converseUserList(user.roles)}}</td>
                        <td>{{statuses[user.status]}}</td>
                      </tr>
                      </tbody>
                    </table>
                  </ng-scrollbar>
                </div>
              </div>
              <!--                <div class="row">-->
              <!--                  <div class="col-sm-12 col-md-5">-->
              <!--                    <div class="dataTables_info" role="status" aria-live="polite">Showing 1 to 10 of 40 entries</div>-->
              <!--                    </div>-->
              <!--                  <div class="col-sm-12 col-md-7">-->
              <!--                    <div class="dataTables_paginate paging_full_numbers">-->
              <!--                      <ul class="pagination">-->
              <!--                    <li class="paginate_button page-item first disabled" >-->
              <!--                      <a href="#" aria-controls="datatables" data-dt-idx="0" tabindex="0" class="page-link">First</a>-->
              <!--                    </li>-->
              <!--                        <li class="paginate_button page-item previous disabled"><a href="#" aria-controls="datatables" data-dt-idx="1" tabindex="0" class="page-link">Prev</a></li><li class="paginate_button page-item active"><a href="#" aria-controls="datatables" data-dt-idx="2" tabindex="0" class="page-link">1</a></li><li class="paginate_button page-item "><a href="#" aria-controls="datatables" data-dt-idx="3" tabindex="0" class="page-link">2</a></li><li class="paginate_button page-item "><a href="#" aria-controls="datatables" data-dt-idx="4" tabindex="0" class="page-link">3</a></li><li class="paginate_button page-item "><a href="#" aria-controls="datatables" data-dt-idx="5" tabindex="0" class="page-link">4</a></li><li class="paginate_button page-item next"><a href="#" aria-controls="datatables" data-dt-idx="6" tabindex="0" class="page-link">Next</a></li><li class="paginate_button page-item last" id="datatables_last"><a href="#" aria-controls="datatables" data-dt-idx="7" tabindex="0" class="page-link">Last</a></li></ul></div></div>-->
              <!--                </div>-->
            </div>
          </div>
          <!--              </ng-scrollbar>-->
          <!--          </div>-->
        </div>
      </div>
    </div>
  </div>
</div>
<ng-template #addNewUser let-modal>
  <div class="card mt-0 mb-0 w742">
    <div class="card-header card-header-success card-header-icon">
      <div class="card-icon">
        <i class="material-icons-outlined">perm_identity</i>
      </div>
      <h4 class="card-title ">Создать пользователя</h4>
      <button type="button" class="close position-absolute" style="top: 10px;right: 0" data-dismiss="modal" aria-label="Close" (click)="close()">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="card-body">
      <form [formGroup]="newUserForm">
        <div class="form-group has-default bmd-form-group">
<!--          [class.error]="this.newUserForm.controls.phone.invalid"-->
          <input type="tel" formControlName="phone"  class="form-control" placeholder="Телефон  *" prefix="+7" mask="(000) 000 00 00">
<!--          ^[1-9]+\d*9-->
        </div>
        <div class="form-group has-default bmd-form-group">
          <input type="email" formControlName="email" class="form-control" placeholder="Email  *">
        </div>
        <div class="form-group has-default bmd-form-group">
          <input type="text" formControlName="password" class="form-control" placeholder="Пароль *">
        </div>
        <div class="form-group has-default bmd-form-group">
          <input type="text" [class.error]="!comparePasswords()"  class="form-control" [formControl]="confirmPassword" placeholder="Повторите пароль *">
        </div>
        <ng-container *ngFor="let role of newUserForm.controls.roleList['controls']; let i=index">
          <div class="d-flex align-items-center">
            <label class="col-form-label">Роль *</label>
<!--            <div class="form-input-md">-->
<!--              <div class="form-group has-default bmd-form-group">-->
                <app-custom-select classes="mr-5" [values]="possibleRoles"
                                   [formControl]="newUserForm.controls.roleList['controls'][i]"></app-custom-select>
<!--              </div>-->
<!--            </div>-->
            <a *ngIf="newUserForm.controls.roleList['controls'][i].value&&newUserForm.controls.roleList['controls'].length-1===i" (click)="$event.preventDefault();addForm(newUserForm.controls.roleList)"><i class="material-icons icon-color">add</i></a>
            <a *ngIf="newUserForm.controls.roleList['controls'][i].value&&newUserForm.controls.roleList['controls'].length-1===i&&i!==0" (click)="$event.preventDefault();deleteLastForm(newUserForm.controls.roleList)"><i class="material-icons icon-color">delete</i></a>
          </div>
        </ng-container>
      </form>
      <div class="d-flex justify-content-end">
        <button class="btn btn-success btn-round" [disabled]="!comparePasswords()||!this.newUserForm.valid" [class.disabled]="!comparePasswords()||!this.newUserForm.valid" (click)="createUser();close()">Сохранить изменения<div class="ripple-container"></div></button>
      </div>
    </div>
  </div>
<!--  <div class="modal-content">-->
<!--    <div class="modal-header">-->
<!--      <h4 class="modal-title">{{'Підтвердіть дію'|translate}}</h4>-->
<!--      <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="modalService.dismissAll(false)">-->
<!--        <span aria-hidden="true">&times;</span>-->
<!--      </button>-->
<!--    </div>-->
<!--    <div class="modal-body">-->
<!--      {{massages[messageType]|translate}}-->
<!--    </div>-->
<!--    <div class="modal-footer justify-content-between">-->
<!--      <button type="button" class="btn btn-default" (click)="modalService.dismissAll(false);">{{'Відміна'|translate}}</button>-->
<!--      <button type="button" class="btn btn-primary" (click)="modal.close(true);">{{'Підтвердити'|translate}}</button>-->
<!--    </div>-->
<!--  </div>-->
</ng-template>
<app-massage-modal #invalidDatesModalContent [messageType]="'invalidDateMassage'"></app-massage-modal>
